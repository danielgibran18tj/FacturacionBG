<div class="modal fade show custom-modal" tabindex="-1" aria-modal="true"
     style="display: block;"
     (click)="$event.target === $event.currentTarget && close.emit()">

  <div class="modal-dialog modal-dialog-slide modal-xl">
    <div class="modal-content border-0 shadow-lg">

      <!-- HEADER -->
      <div class="modal-header border-0" style="background:#d4145a; color:white;">
        <h4 class="modal-title">
          <i class="bi bi-receipt"></i> Factura {{ invoice?.invoiceNumber }}
        </h4>
        <button type="button" class="btn-close btn-close-white" (click)="close.emit()"></button>
      </div>

      <!-- BODY -->
      <div class="modal-body" *ngIf="invoice">

        <!-- Información general -->
        <section class="mb-4">
          <h5 class="section-title">
            <i class="bi bi-info-circle"></i> Información General
          </h5>

          <div class="row g-3">
            <div class="col-md-4"><strong>Fecha:</strong> {{ invoice.invoiceDate | date:'dd/MM/yyyy' }}</div>
            <div class="col-md-4"><strong>Cliente:</strong> {{ invoice.customerName }}</div>
            <div class="col-md-4"><strong>Documento:</strong> {{ invoice.customerDocument }}</div>

            <div class="col-md-4"><strong>Vendedor:</strong> {{ invoice.sellerName }}</div>

            <div class="col-md-4">
              <strong>Estado:</strong>
              <span class="badge bg-success" *ngIf="invoice.status === 'Active'">Pagada</span>
              <span class="badge bg-warning text-dark" *ngIf="invoice.status !== 'Active'">Pendiente</span>
            </div>
          </div>
        </section>

        <!-- Detalle de productos -->
        <section class="mb-4">
          <h5 class="section-title">
            <i class="bi bi-box-seam"></i> Detalle de Productos
          </h5>

          <app-generic-table
            [data]="invoice.details"
            [columns]="detailColumns"
            [actions]="[]"
            [totalPages]="1"
            [currentPage]="1">
          </app-generic-table>
        </section>

        <!-- Pagos y totales -->
        <section class="row g-4">

          <!-- Métodos de pago -->
          <div class="col-md-6">
            <h5 class="section-title">
              <i class="bi bi-credit-card"></i> Pagos
            </h5>

            <app-generic-table
              [data]="invoice.payments"
              [columns]="paymentColumns"
              [actions]="[]"
              [totalPages]="1"
              [currentPage]="1">
            </app-generic-table>
          </div>

          <!-- Totales -->
          <div class="col-md-6">
            <h5 class="section-title">
              <i class="bi bi-wallet2"></i> Totales
            </h5>

            <div class="card border-0 shadow-sm p-3">
              <p><strong>Subtotal:</strong> {{ invoice.subtotal | currency }}</p>
              <p><strong>IVA:</strong> {{ invoice.taxIva | currency }}</p>
              <h4 class="fw-bold text-danger">Total: {{ invoice.total | currency }}</h4>
            </div>
          </div>

        </section>

        <!-- Notas -->
        <section>
          <h5 class="section-title">
            <i class="bi bi-journal-text"></i> Notas
          </h5>

          <div class="card border-0 shadow-sm p-3">
            {{ invoice.notes || 'Sin notas adicionales.' }}
          </div>
        </section>

      </div>

      <div class="modal-footer border-0">
        <button class="btn btn-secondary" (click)="close.emit()">
          <i class="bi bi-x-circle"></i> Cerrar
        </button>
      </div>

    </div>
  </div>
</div>

<div class="modal-backdrop fade show"></div>
